
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Creating cool components with Polymer.Templatizer - Tomasz Pluskiewicz</title>
	<meta name="author" content="Tomasz Pluskiewicz">

	
	<meta name="description" content="How to reuse templates from Light DOM inside Polymer elements">
    
        <meta name="keywords" content="semantic web, .net, programming, blog">
    

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="http://t-code.pl/atom.xml" rel="alternate" title="Tomasz Pluskiewicz" type="application/atom+xml">
	
	<link rel="canonical" href="http://t-code.pl/blog/2015/08/polymer-templatizer/">
	<link href="/favicon.ico" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="/stylesheets/resume.css" media="all" />
<link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-24217426-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<img src="http://www.gravatar.com/avatar/1497654c2d1af3cef4987234d1aced57?s=160" alt="Profile Picture" style="width: 160px;" />
	
</div>
<hgroup>
  <h1><a href="/">Tomasz Pluskiewicz</a></h1>
  
  <h2>Awaiting the Semantic Web</h2>
  
</hgroup>

<nav id="main-nav"><ul class="main">
    <li><a href="/me">About</a></li>
    <li><a href="/resume">Resume</a></li>
    <li><a href="/">Blog</a></li>
    <li><a href="/talks">Presentations</a></li>
    <li><a href="/projects">Projects</a></li>
    <li><a href="/links">Links</a></li>
    <li><a href="/blog/archives">Archives</a></li>
</ul>


</nav>
<nav id="flairs">
    <a href="http://www.w3.org/RDF/" title="RDF Resource Description Framework" target='_blank'> 
        <img border="0" src="http://www.w3.org/RDF/icons/rdf_developer_button.48" alt="RDF Resource Description Framework Developer Icon"/>
    </a>

    <a href="http://stackoverflow.com/users/1103498/tomasz-pluskiewicz" target='_blank'>
        <img src="http://stackoverflow.com/users/flair/1103498.png?theme=clean" width="208" height="58" alt="profile for Tomasz Pluskiewicz at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Tomasz Pluskiewicz at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
    </a>

    <a href='https://www.openhub.net/accounts/132022?ref=Detailed' target='_blank'>
        <img alt='Open Hub profile for Tomasz Pluskiewicz' border='0' height='35' src='https://www.openhub.net/accounts/132022/widgets/account_detailed.gif' width='230' />
    </a>
</nav>

<nav id="smallFlairs">
    <a href='https://www.openhub.net/accounts/132022?ref=Tiny' target='_blank'>
        <img alt='Open Hub profile for Tomasz Pluskiewicz' border='0' height='15' src='https://www.openhub.net/accounts/132022/widgets/account_tiny.gif' width='80' />
    </a>
</nav>

<nav id="sub-nav">
	<div class="social">
		
		
		
		
			<a class="twitter" href="http://twitter.com/tpluscode" title="Twitter">Twitter</a>
		
		
			<a class="github" href="https://github.com/tpluscode" title="GitHub">GitHub</a>
		
		
        
            <a class="stackoverflow" href="http://stackoverflow.com/users/1103498/tomasz-pluskiewicz" title="StackOverflow"></a>
        
        
            <a class="semanticweb" href="http://answers.semanticweb.com/users/1788/tomasz-pluskiewicz" title="SemanticWeb answers"></a>
        
        <a class="ohloh" href="https://www.openhub.net/accounts/132022?ref=Rank" title="Ohloh rank"></a>
		
			<a class="linkedin" href="http://www.linkedin.com/in/tpluskiewicz" title="LinkedIn">LinkedIn</a>
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Creating Cool Components With Polymer.Templatizer</h1>
	<div class="entry-content" itemprop="articleBody"><p>I’ve been looking for a way to create a collection component, in which I would declare the collection 
item template in the <a href="http://webcomponents.org/polyfills/shadow-dom/">Light DOM</a> and then render that template bound to each item. I’m using
Polymer, because it is fun and insanely productive tool for creating Web Components. When I was already
close to actually writing my component in pure Web Component API I discovered the <a href="https://github.com/Polymer/polymer/blob/master/src/lib/template/templatizer.html">Templatizer bevahiour</a>.</p>

<!--more-->

<p>I am working with <a href="http://json-ld.org">JSON-LD</a> and <a href="https://www.w3.org/community/hydra/">Hydra</a>. Nicely compacted, a Hydra collection is a JSON object with
an array of <code>members</code>:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="p">{</span>
</span><span class="line">  <span class="s2">&quot;@context&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class="line">    <span class="s2">&quot;http://www.w3.org/ns/hydra/context.jsonld&quot;</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.w3.org/2000/01/rdf-schema#label&quot;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">],</span>
</span><span class="line">  <span class="s2">&quot;@id&quot;</span><span class="o">:</span> <span class="s2">&quot;http://example.com/my/collection&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="s2">&quot;@type&quot;</span><span class="o">:</span> <span class="s2">&quot;Collection&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="s2">&quot;member&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Item one&quot;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Item two&quot;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">]</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>A simple way to display such collection would be to create a <code>&lt;template is="dom-repeat"&gt;</code> to iterate over the members.
However this isn’t perfect and I wanted a better component, where the item’s template is supplied in the Light DOM.
This way it can be reused for rendering various collections and also extended with <code>&lt;content&gt;</code> tags to support stuff 
like custom header/footer or paging controls (see <a href="http://www.hydra-cg.com/spec/latest/core/#collections">PagedCollection</a>). For the time being, I call it 
simply <code>&lt;hydra-collection&gt;</code>.</p>

<p><strong>TL;DR;</strong> <a href="#templatizer">here’s the working solution</a></p>

<h2 id="first-attempt-doesnt-work">First attempt <em>(¡doesn’t work!)</em></h2>

<p>My naive attempt was to distribute an item template inside a repeater.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- The Light DOM declares an .item element, which is used as the template --&gt;</span>
</span><span class="line"><span class="nt">&lt;hydra-collection</span> <span class="na">collection=</span><span class="s">&quot;{{myCollection}}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;member&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    Label: <span class="nt">&lt;span&gt;</span>{{member.label}}<span class="nt">&lt;/span&gt;</span>
</span><span class="line">  <span class="nt">&lt;/div&gt;</span>
</span><span class="line"><span class="nt">&lt;/hydra-collection&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- Now in my element I place &lt;content&gt; in &lt;dom-repeat&gt; --&gt;</span>
</span><span class="line"><span class="nt">&lt;dom-module</span> <span class="na">id=</span><span class="s">&quot;hydra-collection&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;template&gt;</span>
</span><span class="line">    <span class="nt">&lt;template</span> <span class="na">is=</span><span class="s">&quot;dom-repeat&quot;</span> <span class="na">items=</span><span class="s">&quot;{{collection.members}}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">      <span class="nt">&lt;content</span> <span class="na">select=</span><span class="s">&quot;.member&quot;</span> <span class="na">member=</span><span class="s">&quot;{{item}}&quot;</span><span class="nt">&gt;&lt;/content&gt;</span>
</span><span class="line">    <span class="nt">&lt;/template&gt;</span>
</span><span class="line">  <span class="nt">&lt;/template&gt;</span>
</span><span class="line"><span class="nt">&lt;/dom-module&gt;</span>
</span></code></pre></td></tr></table></div></figure>

<p>Unfortunately this cannot work, because it is not how <code>&lt;content&gt;</code> tags are used. Basically, the first time
the repeating template iterates, all nodes matched by <code>&lt;content&gt;</code> are distributed and subsequent iterations 
render nothing. The other problem is with data binding, which is done in the parent scope. Obviously I need a 
template in the Light DOM.</p>

<h2 id="template-in-light-dom-almost-works"><code>&lt;template&gt;</code> in Light DOM <em>(¡almost works!)</em></h2>

<p>Inspired by a <a href="https://groups.google.com/d/msg/polymer-dev/sEyfXJMAkQc/Ga5_8YGPksEJ">google group post</a> by 
Eric Bidelman I thought that I could define a template in the Light DOM and then clone and bind it inside my 
component. This will first solve the binding problem</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- Template in the Light DOM --&gt;</span>
</span><span class="line"><span class="nt">&lt;hydra-collection</span> <span class="na">collection=</span><span class="s">&quot;{{myCollection}}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;template</span> <span class="na">class=</span><span class="s">&quot;member&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    Label: <span class="nt">&lt;span&gt;</span>{{member.label}}<span class="nt">&lt;/span&gt;</span>
</span><span class="line">  <span class="nt">&lt;/template&gt;</span>
</span><span class="line"><span class="nt">&lt;/hydra-collection&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- &lt;content&gt; sits outside of the repeater --&gt;</span>
</span><span class="line"><span class="nt">&lt;dom-module</span> <span class="na">id=</span><span class="s">&quot;hydra-collection&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;template&gt;</span>
</span><span class="line">    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;repeater&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class="line">    <span class="nt">&lt;content</span> <span class="na">id=</span><span class="s">&quot;templates&quot;</span> <span class="na">select=</span><span class="s">&quot;template.member&quot;</span><span class="nt">&gt;&lt;/content&gt;</span>
</span><span class="line">  <span class="nt">&lt;/template&gt;</span>
</span><span class="line"><span class="nt">&lt;/dom-module&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- distributed template is cloned in loop and added to the Local DOM --&gt;</span>
</span><span class="line"><span class="nt">&lt;script&gt;</span>
</span><span class="line">
</span><span class="line">  <span class="nx">Polymer</span><span class="p">({</span>
</span><span class="line">    <span class="nx">is</span><span class="o">:</span> <span class="s1">&#39;hydra-collection&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="nx">parameters</span><span class="o">:</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">collection</span><span class="o">:</span> <span class="nb">Object</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="nx">ready</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Polymer</span><span class="p">.</span><span class="nx">dom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">templates</span><span class="p">).</span><span class="nx">getDistributedNodes</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span>
</span><span class="line">
</span><span class="line">      <span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">member</span><span class="p">;</span>
</span><span class="line">      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">importNode</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class="line">        <span class="nx">clone</span><span class="p">.</span><span class="nx">member</span> <span class="o">=</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class="line">        <span class="nx">Polymer</span><span class="p">.</span><span class="nx">dom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">repeater</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">clone</span><span class="p">);</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>

<p>This time I tried instantiate the templates by using native <a href="http://www.html5rocks.com/en/tutorials/webcomponents/template/">Web Components API</a>. Unfortunately
the template cloned from a node distributed by Polymer contains only an empty <code>#document-fragment</code>. It may be a problem
with <a href="https://www.polymer-project.org/1.0/articles/shadydom.html">Shady DOM</a> so other Polymer quirk (it definitely works with pure-WC with Shadow DOM). Also the native
way doesn’t help with data binding anyway.</p>

<p>Nevertheless Polymer’s <code>dom-repeat</code> component does a similar thing and looking at the source code I discovered
Polymer.Templatizer.</p>

<h2 id="polymertemplatzier-a-nametemplatizera">Polymer.Templatzier <a name="templatizer"></a></h2>

<p>Polymer.Templatizer is the Polymer way to create instances of templates and takes care of data binding too. It can be 
added to any Polymer element as a <a href="https://www.polymer-project.org/1.0/docs/devguide/behaviors.html">behaviour</a> and adds a number of methods, out of which the most
important are <code>templatize</code> and <code>stamp</code>, which prepare the template and create actual instance respectively.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- Same as above, &lt;template&gt; is used in Light DOM --&gt;</span>
</span><span class="line"><span class="nt">&lt;hydra-collection</span> <span class="na">collection=</span><span class="s">&quot;{{myCollection}}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;template</span> <span class="na">class=</span><span class="s">&quot;member&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    Label: <span class="nt">&lt;span&gt;</span>{{member.label}}<span class="nt">&lt;/span&gt;</span>
</span><span class="line">  <span class="nt">&lt;/template&gt;</span>
</span><span class="line"><span class="nt">&lt;/hydra-collection&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- &lt;content&gt; sits outside of the repeater --&gt;</span>
</span><span class="line"><span class="nt">&lt;dom-module</span> <span class="na">id=</span><span class="s">&quot;hydra-collection&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;template&gt;</span>
</span><span class="line">    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;repeater&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class="line">    <span class="nt">&lt;content</span> <span class="na">id=</span><span class="s">&quot;templates&quot;</span> <span class="na">select=</span><span class="s">&quot;template.member&quot;</span><span class="nt">&gt;&lt;/content&gt;</span>
</span><span class="line">  <span class="nt">&lt;/template&gt;</span>
</span><span class="line"><span class="nt">&lt;/dom-module&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- templates are instantiated with Templatizer instead --&gt;</span>
</span><span class="line"><span class="nt">&lt;script&gt;</span>
</span><span class="line">
</span><span class="line">  <span class="c1">// add Templatizer behavior</span>
</span><span class="line">  <span class="nx">Polymer</span><span class="p">({</span>
</span><span class="line">    <span class="nx">is</span><span class="o">:</span> <span class="s1">&#39;hydra-collection&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="nx">behaviors</span><span class="o">:</span> <span class="p">[</span>
</span><span class="line">      <span class="nx">Polymer</span><span class="p">.</span><span class="nx">Templatizer</span>
</span><span class="line">    <span class="p">],</span>
</span><span class="line">    <span class="nx">parameters</span><span class="o">:</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">collection</span><span class="o">:</span> <span class="nb">Object</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="nx">ready</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Polymer</span><span class="p">.</span><span class="nx">dom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">templates</span><span class="p">).</span><span class="nx">getDistributedNodes</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span>
</span><span class="line">
</span><span class="line">      <span class="c1">// templatize must be called once before stamp is called</span>
</span><span class="line">      <span class="k">this</span><span class="p">.</span><span class="nx">templatize</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">      <span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">member</span><span class="p">;</span>
</span><span class="line">      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">        <span class="c1">// clone the template and bind with the model</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stamp</span><span class="p">({});</span>
</span><span class="line">        <span class="nx">clone</span><span class="p">.</span><span class="nx">member</span> <span class="o">=</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class="line">
</span><span class="line">        <span class="c1">// append clone.root to DOM instead</span>
</span><span class="line">        <span class="nx">Polymer</span><span class="p">.</span><span class="nx">dom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">repeater</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">clone</span><span class="p">.</span><span class="nx">root</span><span class="p">);</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>

<p>This works like charm but I find two minor issues with this API. First, it is weird that <code>templatize</code> doesn’t return
a value, but rather modifies some internal state used by <code>stamp</code>. I would prefer that to be more functional:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">templatize</span><span class="p">(</span><span class="nx">templateNode</span><span class="p">);</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="p">{</span> <span class="p">});</span>
</span><span class="line"><span class="nx">dom</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">clone</span><span class="p">.</span><span class="nx">root</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>

<p>Second is a problem with the stamp method. The documentation says it accepts an object with the initial state to bind
to but that didn’t work for me. It is merely a nuisance though, because any property set on the stamped clone and bound
just fine. So, that’s why instead of</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">member</span><span class="o">:</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

<p>I had to write</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="p">{</span> <span class="p">});</span>
</span><span class="line"><span class="nx">clone</span><span class="p">.</span><span class="nx">member</span> <span class="o">=</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>

<p>I’m not sure why I had this problem though, because it sure as hell <a href="http://plnkr.co/edit/MyPOz12b2MkTpfravUGy">works in plunker</a>.</p>

<h2 id="bottom-line">Bottom line</h2>

<p>I very much like the Templatizer <img class="emoji" title=":heart_eyes:" alt=":heart_eyes:" src="https://assets.github.com/images/icons/emoji/unicode/1f60d.png" height="20" width="20" align="absmiddle" />. It makes it possible to create very rich and composable web components 
while still giving the developers full power of Polymer magic! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://assets.github.com/images/icons/emoji/unicode/2728.png" height="20" width="20" align="absmiddle" /></p>

</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2021

    Tomasz Pluskiewicz


Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
		</div>
	</div>
	

<script type="text/javascript">
      var disqus_shortname = 'tcode';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://t-code.pl/blog/2015/08/polymer-templatizer/';
        var disqus_url = 'http://t-code.pl/blog/2015/08/polymer-templatizer/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
